<div class="language-selector">
  {% assign pages=site.pages | where:"ref", page.ref | sort: 'lang' %}
  {% assign unique_langs = "" | split: "" %}
  
  {% for p in pages %}
    {% unless unique_langs contains p.lang %}
      {% assign unique_langs = unique_langs | push: p.lang %}
      <a href="{{ site.baseurl }}{{ p.url }}" class="lang-link {% if p.lang == page.lang %}active{% endif %}">{{ p.lang_name }}</a>
    {% endunless %}
  {% endfor %}
</div>
